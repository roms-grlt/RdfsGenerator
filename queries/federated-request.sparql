# Requête fédérée (SERVICE) : récupère les films Amazon avec leurs réalisateurs
# et enrichit les données avec des biographies depuis DBpedia
PREFIX unified: <http://example.org/unified/>
PREFIX amazon: <http://example.org/amazon/>
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX dbr: <http://dbpedia.org/resource/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?film ?title ?director ?directorBio
WHERE {
  ?film a amazon:AmazonFilm ;
        unified:title ?title ;
        amazon:directedBy ?director .

  SERVICE <https://dbpedia.org/sparql> {
    ?directorUri rdfs:label ?director .
    ?directorUri dbo:abstract ?directorBio .
    FILTER(LANG(?directorBio) = "en")
  }
}
LIMIT 10