PREFIX unified: <http://example.org/unified/>
PREFIX amazon: <http://example.org/amazon/>
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?film ?title ?director ?directorBio
WHERE {
  # 1. Limiter d'abord les films locaux (plus efficace avant SERVICE)
  {
    SELECT ?film ?title ?director
    WHERE {
      ?film a amazon:AmazonFilm ;
            unified:title ?title ;
            amazon:directedBy ?director .
    }
    LIMIT 20
  }
  
  # 2. SERVICE optimisé avec FILTER sur label
  SERVICE <https://dbpedia.org/sparql> {
    ?directorUri rdfs:label ?director ;
                 dbo:abstract ?directorBio .
    
    # Filtres groupés pour réduire les résultats intermédiaires
    FILTER(LANG(?director) = "en" && LANG(?directorBio) = "en")
  }
}