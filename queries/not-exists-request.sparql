# Requête FILTER NOT EXISTS : films familiaux sans contenu inapproprié
# Films bien notés qui n'ont pas de violence ou contenu adulte
PREFIX unified: <http://example.org/unified/>
PREFIX imdb: <http://example.org/imdb/>

SELECT ?title ?rating ?genre ?certificate
WHERE {
  ?film a unified:film ;
        unified:title ?title ;
        unified:rating ?rating .

  OPTIONAL { ?film unified:genre ?genre }
  OPTIONAL { ?film imdb:certificate ?certificate }

  # Exclure les films avec violence modérée ou sévère
  FILTER NOT EXISTS {
    ?film imdb:violence ?violence .
    FILTER(?violence IN ("Moderate", "Severe"))
  }

  # Exclure les films avec classification adulte
  FILTER NOT EXISTS {
    ?film imdb:certificate ?cert .
    FILTER(?cert IN ("R", "NC-17", "TV-MA"))
  }

  # Exclure les films avec nudité
  FILTER NOT EXISTS {
    ?film imdb:nudity ?nudity .
    FILTER(?nudity IN ("Moderate", "Severe"))
  }

  FILTER(?rating >= 4.0)
}
ORDER BY DESC(?rating)
LIMIT 30
