# Requête OPTIONAL : récupère les informations des films avec données optionnelles multi-sources
# Démontre l'intégration de données provenant de différentes sources (Amazon, Netflix, IMDB)
# Les champs optionnels peuvent être absents selon la source du film
PREFIX unified: <http://example.org/unified/>
PREFIX amazon: <http://example.org/amazon/>
PREFIX netflix: <http://example.org/netflix/>
PREFIX imdb: <http://example.org/imdb/>

SELECT ?title ?genre ?rating ?duration ?language ?violence ?certificate
WHERE {
  ?film a unified:film ;
        unified:title ?title .

  # Genre (peut venir d'IMDB ou Netflix)
  OPTIONAL {
    { ?film imdb:genre ?genre }
    UNION
    { ?film netflix:genre ?genre }
  }

  # Rating (peut venir d'Amazon ou Netflix)
  OPTIONAL {
    { ?film amazon:rating ?rating }
    UNION
    { ?film netflix:rating ?rating }
  }

  # Durée (seulement disponible sur IMDB et Netflix)
  OPTIONAL { ?film unified:duration ?duration }

  # Langue (seulement disponible sur Netflix)
  OPTIONAL { ?film netflix:language ?language }

  # Violence (seulement disponible sur IMDB)
  OPTIONAL { ?film imdb:violence ?violence }

  # Certificat/Classification (disponible sur IMDB)
  OPTIONAL { ?film imdb:certificate ?certificate }
}
ORDER BY ?title
LIMIT 30
